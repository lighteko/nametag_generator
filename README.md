# 자동 이름표 생성기 (Auto Nametag Generator)

Excel 파일의 이름 목록을 기반으로 자동으로 이름표 이미지를 생성하는 Next.js 웹 애플리케이션입니다.

## 기능

- Excel 파일에서 이름 목록을 읽어와 자동으로 이름표 이미지 생성
- 큰 이름표와 작은 이름표 배경 이미지 지원
- 학생 여부에 따라 자동으로 이름표 크기 선택
- 여러 배경 이미지 중 랜덤 선택
- 생성된 이미지를 ZIP 파일로 자동 다운로드
- **Excel 데이터 유효성 검사**: 필수 필드 확인 (교회 필드만 선택사항)
- **진행률 표시**: 이름표 생성 과정을 실시간으로 표시
- **오류 메시지**: 친숙한 오류 메시지 표시

## 필요한 Excel 파일 형식

Excel 파일은 다음 4개의 컬럼을 포함해야 합니다:

| 성명 | 교회 | 나이/학년/직책 | 학생 여부 |
|------|------|----------------|-----------|
| 홍길동 | 새생명교회 | 고등학생 | T |
| 김철수 | 새생명교회 | 집사 | F |

- **성명**: 이름표에 표시될 이름
- **교회**: 교회 이름
- **나이/학년/직책**: 나이, 학년, 또는 직책 정보
- **학생 여부**: 'T'이면 작은 이름표, 그 외는 큰 이름표 사용

## 데이터 유효성 검사

시스템은 다음과 같은 유효성 검사를 수행합니다:

### 필수 필드
- **성명**: 반드시 입력해야 합니다
- **나이/학년/직책**: 반드시 입력해야 합니다  
- **학생 여부**: 반드시 입력해야 합니다

### 선택 필드
- **교회**: 비어있어도 됩니다

### 오류 처리
- 필수 필드가 비어있으면 상세한 오류 메시지가 표시됩니다
- 몇 번째 줄에 어떤 필드가 비어있는지 정확히 알려줍니다
- 교회 필드가 비어있으면 이름표에서 해당 부분이 생략되고 레이아웃이 자동 조정됩니다

## 사용 방법

1. **이름표 배경 이미지 업로드**
   - 큰 이름표: 성인용 이름표 배경 이미지들
   - 작은 이름표: 학생용 이름표 배경 이미지들
   - 각 슬롯에 여러 개의 이미지를 업로드할 수 있습니다

2. **Excel 파일 업로드**
   - 위의 형식에 맞는 Excel 파일을 업로드합니다

3. **이름표 생성**
   - "이름표 생성하기" 버튼을 클릭하면 자동으로 ZIP 파일이 다운로드됩니다

## 설치 및 실행

### 개발 환경

```bash
# 의존성 설치
npm install

# 개발 서버 실행
npm run dev
```

### 프로덕션 환경

```bash
# 프로덕션 빌드
npm run build

# 프로덕션 서버 실행
npm start
```

## Vercel 배포

이 애플리케이션은 Vercel에서 바로 배포할 수 있습니다.

1. GitHub 리포지토리에 코드 푸시
2. Vercel 대시보드에서 프로젝트 import
3. 자동 배포 완료

## 기술 스택

- **Frontend**: Next.js, React, TypeScript
- **Image Processing**: Canvas API
- **File Handling**: react-dropzone, xlsx, formidable
- **Archive**: JSZip, file-saver
- **Deployment**: Vercel

## 주요 특징

- **반응형 디자인**: 모바일과 데스크톱 모두에서 사용 가능
- **드래그 앤 드롭**: 직관적인 파일 업로드 인터페이스
- **자동 처리**: 학생 여부에 따라 자동으로 이름표 크기 결정
- **랜덤 선택**: 여러 배경 이미지 중 랜덤하게 선택하여 다양성 제공
- **일괄 처리**: 모든 이름표를 한 번에 생성하여 ZIP 파일로 제공
- **한글 지원**: 완벽한 한글 텍스트 렌더링 지원
- **큰 폰트 크기**: 가독성을 위한 큰 폰트 사이즈 (기존 대비 2배)
- **스마트 레이아웃**: 교회명 좌측 배치, 이름 중앙 배치

## 지원 파일 형식

- **이미지**: PNG, JPG, JPEG, GIF, BMP
- **Excel**: XLSX, XLS

## 한글 텍스트 지원

### 자동 폰트 지원
시스템이 자동으로 다음 한글 폰트를 시도합니다:
- Noto Sans KR (권장)
- 맑은 고딕 (Windows)
- Apple SD Gothic Neo (macOS)
- 돋움, 굴림, 바탕 (기타 시스템 폰트)

### 한글 폰트 문제 해결
만약 한글이 깨져서 나타나면:

1. **폰트 파일 추가 (권장)**:
   - [Noto Sans KR](https://fonts.google.com/noto/specimen/Noto+Sans+KR)에서 폰트 다운로드
   - `public/fonts/NotoSansKR-Regular.ttf`로 저장
   - 서버 재시작

2. **시스템 폰트 확인**:
   - Windows: 맑은 고딕 폰트가 설치되어 있는지 확인
   - macOS: 기본적으로 한글 폰트 지원됨

3. **폰트 캐시 초기화**:
   ```bash
   # 개발 서버 재시작
   npm run dev
   ```

## 문의사항

이 애플리케이션 사용 중 문제가 있거나 개선 사항이 있으시면 언제든지 문의해 주세요. 